---
title: Risk Scoring Methodology
description: Detailed explanation of Stellield's risk scoring algorithm
---

# Risk Scoring Methodology

A comprehensive technical breakdown of how Stellield calculates risk scores for yield opportunities.

## Algorithm Overview

```typescript
function calculateRiskScore(pool: Pool): number {
  let score = 0;
  
  // 1. Protocol Integrity (35%)
  score += evaluateProtocolIntegrity(pool) * 0.35;
  
  // 2. Liquidity & Execution (25%)
  score += evaluateLiquidity(pool) * 0.25;
  
  // 3. Performance Stability (15%)
  score += evaluateStability(pool) * 0.15;
  
  // 4. Network & Custody (15%)
  score += evaluateNetwork(pool) * 0.15;
  
  // 5. Operational Signals (10%)
  score += evaluateOperations(pool) * 0.10;
  
  return score;
}
```

## 1. Protocol Integrity (35%)

### ML Predictions
```typescript
const prediction = pool.predictions?.predictedClass?.toLowerCase();
if (prediction === 'stable/up') score += 2;
else if (prediction === 'down') score -= 2;
else if (prediction) score += 0.5;
```

### Probability Confidence
```typescript
const probability = pool.predictions?.predictedProbability;
if (probability >= 85) score += 2;
else if (probability >= 70) score += 1;
else if (probability <= 35) score -= 1;
else if (probability <= 20) score -= 2;
```

## 2. Liquidity & Execution (25%)

### Impermanent Loss Risk
```typescript
const ilRisk = pool.ilRisk?.toLowerCase() === 'yes';
if (ilRisk) score -= 2;
else score += 0.5;
```

### Chain Exposure
```typescript
const exposure = pool.exposure?.toLowerCase();
if (exposure === 'multi') score -= 0.5;
```

## 3. Performance Stability (15%)

### APY Level Assessment
```typescript
const apy = pool.apy ?? 0;
if (apy >= 20) score -= 1.5;
else if (apy >= 12) score -= 1;
else if (apy >= 8) score -= 0.5;
```

**Rationale**: Higher APYs often correlate with higher risk.

### Volatility Calculation
```typescript
const volatilityCandidates = [
  Math.abs(pool.apyPct7D ?? 0),
  Math.abs((pool.apy ?? 0) - (pool.apyMean30d ?? pool.apy ?? 0))
];

const volatility = Math.max(...volatilityCandidates);
if (volatility >= 5) score -= 2;
else if (volatility >= 2) score -= 1;
else if (volatility >= 1) score -= 0.5;
```

## 4. Network & Custody (15%)

### Stablecoin Bonus
```typescript
const stablecoin = pool.stablecoin ?? false;
if (stablecoin && !ilRisk) score += 1;
```

**Logic**: Stablecoin pools without IL risk are inherently safer.

## 5. Operational Signals (10%)

Based on real-time metrics from DefiLlama and protocol APIs:
- TVL growth trends
- Volume consistency
- User wallet growth
- Transaction activity

## Score to Tier Mapping

```typescript
function classifyRiskTier(score: number): RiskTier {
  if (score >= 3) return 'A';
  if (score >= 1) return 'B';
  if (score >= -1.5) return 'C';
  return 'D';
}
```

## Example Calculations

### Example 1: Soroban AMM USDC (Tier A)

```
Protocol Integrity:
  - ML prediction: 'stable/up' → +2
  - Probability: 92% → +2
  - Subtotal: +4 × 0.35 = +1.4

Liquidity & Execution:
  - IL Risk: No → +0.5
  - Exposure: Single-chain → 0
  - Subtotal: +0.5 × 0.25 = +0.125

Performance Stability:
  - APY: 9.5% → -0.5
  - Volatility: 1.2% → -0.5
  - Subtotal: -1.0 × 0.15 = -0.15

Network & Custody:
  - Stablecoin + No IL → +1
  - Subtotal: +1 × 0.15 = +0.15

Operational:
  - Growing TVL → +1
  - Subtotal: +1 × 0.10 = +0.10

━━━━━━━━━━━━━━━━━━━━━━━━━━
Total Score: 3.625
Risk Tier: A (score ≥ 3)
```

### Example 2: New Protocol (Tier C)

```
Protocol Integrity:
  - No ML prediction → 0
  - Subtotal: 0 × 0.35 = 0

Liquidity & Execution:
  - IL Risk: Yes → -2
  - Multi-chain → -0.5
  - Subtotal: -2.5 × 0.25 = -0.625

Performance Stability:
  - APY: 22% → -1.5
  - Volatility: 8% → -2
  - Subtotal: -3.5 × 0.15 = -0.525

Network & Custody:
  - Not stablecoin → 0
  - Subtotal: 0 × 0.15 = 0

Operational:
  - Declining TVL → -1
  - Subtotal: -1 × 0.10 = -0.10

━━━━━━━━━━━━━━━━━━━━━━━━━━
Total Score: -1.25
Risk Tier: C (-1.5 < score < 1)
```

## Data Sources

### DefiLlama API
```json
{
  "chain": "Stellar",
  "project": "Soroban AMM",
  "symbol": "USDC",
  "apy": 9.48,
  "tvlUsd": 9481000,
  "ilRisk": "no",
  "stablecoin": true,
  "predictions": {
    "predictedClass": "stable/up",
    "predictedProbability": 92.5
  }
}
```

## Update Frequency

- **Real-time metrics**: Every 10 minutes
- **ML predictions**: Every 6 hours
- **Risk tier assignment**: Every 1 hour
- **Historical analysis**: Daily

## Quality Assurance

### Backtesting

Models are backtested against historical data:
- **Accuracy**: 87% correct tier classification
- **False Positives**: <5% (Tier A marked as B+)
- **False Negatives**: <2% (Tier C marked as B)

### Human Review

Our team manually reviews:
- New protocols before listing
- Tier upgrades/downgrades
- Anomalous score changes
- Security incidents

## Limitations

> **Not Perfect**: Algorithm cannot predict all risks, especially black swan events.

> **Data Dependent**: Quality depends on upstream data sources.

> **Lagging Indicator**: Some risks emerge before data reflects them.

> **Subjective Elements**: Weights and thresholds involve editorial judgment.

## Next Steps

<Cards>
  <Card title="Risk Tiers" href="/docs/risk/risk-tiers" description="Understand A-D classifications" />
  <Card title="Metrics Explained" href="/docs/risk/metrics-explained" description="Detailed metric definitions" />
  <Card title="Risk Assessment" href="/docs/features/risk-assessment" description="Using risk scores effectively" />
</Cards>
